# Aliyun Production

## VPC
* 云上私有网络，可以完全掌握
* 可以自定义私有网络中的使用资源，包括
  1. ECS
  2. SLB
  3. RDS
* 每个 VPC 都由一个「私网网段」，一个「路由器」和至少一个「交换机」组成
* 每个VPC都有一个独立的「隧道号」，一个隧道号对应着一个虚拟化网络。专有网络之间通过隧道ID进行隔离
* 专有网络内部由于交换机和路由器的存在，所以可以像传统网络环境一样「划分子网」，每一个子网内部的不同云服务器使用同一个交换机互联，「不同子网间使用路由器互联」
* 不同专有网络之间内部网络完全隔离（因为隧道号不同），可以通过对外映射的IP（弹性公网IP和NAT IP）互连
* 专有网络内的ECS使用安全组防火墙进行三层网络访问控制 （网络层 + 数据链路 + 物理层），基于IP + PORT 的配置
* 由于使用隧道封装技术对云服务器的IP报文进行封装，所以云服务器的数据链路层（二层MAC地址）信息不会进入物理网络，实现了不同云服务器间二层网络隔离，因此也实现了不同专有网络间二层网络隔离（？）

### 私网网段
决定了私有网络中的 IP 地址个数，采用 CIDR（classless inter-domain routing）的方式去指明，比如：
* 192.168.0.0/16 -> 会产生 65532 个可用的内网 IP 地址
* 172.16.0.0/12 -> 会产生 1048572 个可用的内网 IP 地址
* 10.0.0.0/8 -> 会产生 	16777212 个可用的内网 IP 地址

### 路由器（vRouter）
本质上就是一个 VPC 的出入口网关，是 VPC 的「枢纽」
* 可以连接 VPC 内的各个交换机
* 连接 VPC 和其他网络设备的网关

### 交换机（vSwitch）
是组成专有网络的基础网络设备，用来连接不同的云产品实例。主要可以用交换机来「划分子网」
* 同一个 VPC 不同交换机内网互通
* 交换机可以部署在同一区域内「不同可用区」中，这样可以用来提高可用性

### VPC 内的 ECS 如何连接公网
* 创建 ECS 的时候直接赋予公网 IP
* 创建弹性 IP 并直接赋予某个 ECS
* 给一个 VPC 创建 NAT 网关，给这个 NAT 网关绑定一个 EIP，创建 SNAT 和 DNAT 规则
* 创建公网 SLB 

### EIP
是可以独立购买和持有的「公网 IP」资源。弹性公网 IP 是一种 NAT IP（实际位于阿里云的公网网关上，通过 NAT 配置的方式映射到被绑定的资源上。和资源绑定之后，该资源可以通过 EIP 与公网通信），目前支持的资源有：
1. ECS
2. 弹性网卡
3. VPC 的私网 SLB
4. VPC 的私网 NAT 网关

它的好处有：
1. 可以独立购买和持有
2. 弹性绑定，可以随时绑定和解绑
3. 可以针对 IP 进行网络配置

### NAT 网关
是针对 VPC 的「公网网关」，提供 SNAT 与 DNAT 代理

### 访问控制
* ECS 安全组
* RDS 白名单
* SLB 白名单



